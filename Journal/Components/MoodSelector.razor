@using Journal.Models

<label>Primary Mood</label>
<select class="form-select" @bind="PrimaryMood" @bind:after="OnPrimaryMoodChanged">
    @foreach (var mood in Enum.GetValues(typeof(MoodType)).Cast<MoodType>())
    {
        <option value="@mood">@mood</option>
    }
</select>

<label class="mt-2">Secondary Mood</label>
<select class="form-select" value="@SecondaryMood" @onchange="OnSecondaryMoodChanged">
    <option value="">None</option>
    @foreach (var mood in Enum.GetValues(typeof(MoodType)).Cast<MoodType>())
    {
        <option value="@mood">@mood</option>
    }
</select>

@code {
    [Parameter]
    public MoodType PrimaryMood { get; set; } = MoodType.Happy;

    [Parameter]
    public EventCallback<MoodType> PrimaryMoodChanged { get; set; }

    [Parameter]
    public MoodType? SecondaryMood { get; set; }

    [Parameter]
    public EventCallback<MoodType?> SecondaryMoodChanged { get; set; }

    private async Task OnPrimaryMoodChanged()
    {
        await PrimaryMoodChanged.InvokeAsync(PrimaryMood);
    }

    private async Task OnSecondaryMoodChanged(ChangeEventArgs e)
    {
        if (string.IsNullOrEmpty(e.Value?.ToString()))
        {
            SecondaryMood = null;
        }
        else
        {
            SecondaryMood = Enum.Parse<MoodType>(e.Value.ToString()!);
        }
        await SecondaryMoodChanged.InvokeAsync(SecondaryMood);
    }
}